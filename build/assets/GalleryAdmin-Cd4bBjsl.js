var L=Object.defineProperty;var V=(i,r,s)=>r in i?L(i,r,{enumerable:!0,configurable:!0,writable:!0,value:s}):i[r]=s;var b=(i,r,s)=>V(i,typeof r!="symbol"?r+"":r,s);import{bn as j,bo as F,bp as E,bq as M,j as t,aE as g,ao as p,aG as H}from"./index-Cjn3py5b.js";import{r as c}from"./vendor-BagLKi1z.js";import{F as A}from"./FileUploadCloudinary-BXH5zxUQ.js";import{F as l,I as h,e as O}from"./index-2ZNh93OQ.js";import{s as n}from"./index-lI4ucwGs.js";import{C as R}from"./index-7W5owr5O.js";import{F as q,P as B}from"./Table-DOoVuXeP.js";import{M as X,S as x,R as $}from"./DeleteOutlined-DhB81-EL.js";import{I as D}from"./index-CRVR9_FD.js";import"./icons-X9-Iq-vF.js";import"./notifications-DStr16IZ.js";import"./index-B-P4hzy5.js";class K{constructor(){b(this,"subscribers",[])}initialize(){this.notify()}async getAllGalleryItems(){return j()}async getGalleryItemById(r){return(await j()).find(a=>a.id===r)}async createGalleryItem(r){const s=await F(r);return this.notify(),s}async updateGalleryItem(r,s){try{const a=await E(r,s);return this.notify(),a}catch{return null}}async deleteGalleryItem(r){try{return await M(r),this.notify(),!0}catch{return!1}}subscribe(r){return this.subscribers.push(r),()=>{this.subscribers=this.subscribers.filter(s=>s!==r)}}notify(){this.subscribers.forEach(r=>r())}}const u=new K,{Search:P}=h,ae=()=>{const[i,r]=c.useState([]),[s,a]=c.useState(!1),[m,I]=c.useState(null),[w,f]=c.useState(""),[d]=l.useForm();c.useEffect(()=>{y()},[]);const y=async()=>{try{const e=await u.getAllGalleryItems();r(e)}catch(e){console.error("Lá»—i táº£i gallery:",e),n.error("KhÃ´ng thá»ƒ táº£i gallery")}},G=()=>{I(null),d.resetFields(),a(!0)},T=e=>{I(e.id),d.setFieldsValue({title:e.title,type:e.type,thumbnail:e.thumbnail,videoId:e.videoId,description:e.description}),a(!0)},v=async()=>{try{const e=await d.validateFields();m?(await u.updateGalleryItem(m,e),n.success("Cáº­p nháº­t thÃ nh cÃ´ng")):(await u.createGalleryItem(e),n.success("ThÃªm má»›i thÃ nh cÃ´ng")),a(!1),y()}catch(e){console.error("Lá»—i lÆ°u gallery item:",e),n.error(`Lá»—i lÆ°u dá»¯ liá»‡u: ${e instanceof Error?e.message:"Lá»—i khÃ´ng xÃ¡c Ä‘á»‹nh"}`)}},S=async e=>{try{await u.deleteGalleryItem(e)?(n.success("XÃ³a thÃ nh cÃ´ng"),y()):n.error("XÃ³a tháº¥t báº¡i")}catch(o){console.error("Lá»—i xÃ³a gallery item:",o),n.error("XÃ³a tháº¥t báº¡i")}},C=i.filter(e=>e.title.toLowerCase().includes(w.toLowerCase())),k=[{title:"TiÃªu Ä‘á»",dataIndex:"title",key:"title"},{title:"Loáº¡i",dataIndex:"type",key:"type",render:e=>e==="image"?"ğŸ“· HÃ¬nh":"ğŸ¥ Video"},{title:"MÃ´ táº£",dataIndex:"description",key:"description"},{title:"Thumbnail",dataIndex:"thumbnail",key:"thumbnail",render:e=>t.jsx(D,{src:e,width:60})},{title:"Thao tÃ¡c",key:"actions",render:(e,o)=>t.jsxs(g,{children:[t.jsx(p,{icon:t.jsx(H,{}),onClick:()=>T(o)}),t.jsx(B,{title:"Báº¡n cÃ³ cháº¯c muá»‘n xÃ³a?",onConfirm:()=>S(o.id),okText:"XÃ³a",cancelText:"Há»§y",children:t.jsx(p,{danger:!0,icon:t.jsx($,{})})})]})}];return t.jsxs("div",{children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16},children:[t.jsx("h2",{children:"Quáº£n LÃ½ ThÆ° Viá»‡n HÃ¬nh áº¢nh & Video"}),t.jsxs(g,{children:[t.jsx(P,{placeholder:"TÃ¬m kiáº¿m...",onSearch:e=>f(e),onChange:e=>f(e.target.value),style:{width:240},allowClear:!0}),t.jsx(p,{type:"primary",icon:t.jsx(O,{}),onClick:G,children:"ThÃªm má»›i"})]})]}),t.jsx(R,{children:t.jsx(q,{dataSource:C,columns:k,rowKey:"id"})}),t.jsx(X,{title:m?"Sá»­a HÃ¬nh áº¢nh/Video":"ThÃªm HÃ¬nh áº¢nh/Video",open:s,onCancel:()=>a(!1),onOk:v,okText:"LÆ°u",children:t.jsxs(l,{form:d,layout:"vertical",children:[t.jsx(l.Item,{name:"title",label:"TiÃªu Ä‘á»",rules:[{required:!0,message:"Vui lÃ²ng nháº­p tiÃªu Ä‘á»"}],children:t.jsx(h,{})}),t.jsx(l.Item,{name:"type",label:"Loáº¡i",initialValue:"image",rules:[{required:!0}],children:t.jsxs(x,{children:[t.jsx(x.Option,{value:"image",children:"HÃ¬nh áº£nh"}),t.jsx(x.Option,{value:"video",children:"Video"})]})}),t.jsx(l.Item,{name:"thumbnail",label:"Thumbnail",rules:[{required:!0,message:"Vui lÃ²ng chá»n thumbnail"}],children:t.jsx(A,{folder:"gallery"})}),t.jsx(l.Item,{name:"videoId",label:"ID Video (YouTube)",children:t.jsx(h,{})}),t.jsx(l.Item,{name:"description",label:"MÃ´ táº£",children:t.jsx(h,{})})]})})]})};export{ae as default};
