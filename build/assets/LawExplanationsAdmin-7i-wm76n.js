import{cI as E,j as e,ao as o,aE as x,aG as S,cJ as k,cK as C,cL as D}from"./index-Cjn3py5b.js";import{r as c}from"./vendor-BagLKi1z.js";import{F as a,e as F,I as s}from"./index-2ZNh93OQ.js";import{s as r}from"./index-lI4ucwGs.js";import{C as M}from"./index-7W5owr5O.js";import{F as N,P}from"./Table-DOoVuXeP.js";import{M as R,R as v}from"./DeleteOutlined-DhB81-EL.js";import"./icons-X9-Iq-vF.js";import"./notifications-DStr16IZ.js";import"./index-B-P4hzy5.js";const $=()=>{const[p,j]=c.useState([]),[y,u]=c.useState(!1),[f,l]=c.useState(!1),[d,i]=c.useState(null),[h]=a.useForm();c.useEffect(()=>{m()},[]);const m=async()=>{try{u(!0);const t=await E();j(t)}catch(t){console.error(t),r.error("Không thể tải dữ liệu")}finally{u(!1)}},g=()=>{i(null),h.resetFields(),l(!0)},w=t=>{i(t),h.setFieldsValue(t),l(!0)},b=async t=>{try{await D(t),r.success("Xóa thành công"),await m()}catch(n){console.error(n),r.error("Xóa thất bại")}},I=async t=>{try{const n={...t,relatedLaws:t.relatedLaws?t.relatedLaws.split(",").map(T=>T.trim()):[]};d&&d.id?(await k(d.id,n),r.success("Cập nhật thành công")):(await C(n),r.success("Thêm mới thành công")),l(!1),i(null),await m()}catch(n){console.error(n),r.error("Lưu thất bại")}},L=[{title:"Tiêu đề",dataIndex:"title",key:"title"},{title:"Số hiệu",dataIndex:"lawNumber",key:"lawNumber"},{title:"Danh mục",dataIndex:"category",key:"category"},{title:"Tác giả",dataIndex:"author",key:"author"},{title:"Ngày",dataIndex:"datePublished",key:"datePublished",render:t=>t?new Date(t).toLocaleDateString("vi-VN"):""},{title:"Hành động",key:"actions",render:(t,n)=>e.jsxs(x,{children:[e.jsx(o,{icon:e.jsx(S,{}),onClick:()=>w(n)}),e.jsx(P,{title:"Bạn có chắc muốn xóa?",onConfirm:()=>b(n.id),okText:"Xóa",cancelText:"Hủy",children:e.jsx(o,{danger:!0,icon:e.jsx(v,{})})})]})}];return e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16},children:[e.jsx("h2",{children:"Quản lý Giải thích văn bản pháp luật"}),e.jsx(o,{type:"primary",icon:e.jsx(F,{}),onClick:g,children:"Thêm mới"})]}),e.jsx(M,{children:e.jsx(N,{dataSource:p,columns:L,rowKey:"id",loading:y})}),e.jsx(R,{title:d?"Sửa":"Thêm mới",open:f,onCancel:()=>{l(!1),i(null)},footer:null,children:e.jsxs(a,{form:h,layout:"vertical",onFinish:I,initialValues:{},children:[e.jsx(a.Item,{name:"title",label:"Tiêu đề",rules:[{required:!0}],children:e.jsx(s,{})}),e.jsx(a.Item,{name:"lawNumber",label:"Số hiệu",children:e.jsx(s,{})}),e.jsx(a.Item,{name:"category",label:"Danh mục",children:e.jsx(s,{})}),e.jsx(a.Item,{name:"author",label:"Tác giả",children:e.jsx(s,{})}),e.jsx(a.Item,{name:"datePublished",label:"Ngày xuất bản",children:e.jsx(s,{placeholder:"YYYY-MM-DD"})}),e.jsxs(a.Item,{name:"relatedLaws",label:"Văn bản liên quan",extra:"Phân tách bởi dấu phẩy",children:[" ",e.jsx(s,{})," "]}),e.jsx(a.Item,{name:"content",label:"Nội dung",rules:[{required:!0}],children:e.jsx(s.TextArea,{rows:6})}),e.jsx(a.Item,{style:{marginTop:16},children:e.jsxs(x,{children:[e.jsx(o,{htmlType:"submit",type:"primary",children:"Lưu"}),e.jsx(o,{onClick:()=>{l(!1),i(null)},children:"Hủy"})]})})]})})]})};export{$ as default};
