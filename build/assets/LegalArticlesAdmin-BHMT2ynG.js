import{a4 as P,j as e,ao as c,aE as m,aG as v,c0 as N,c1 as Y,c2 as M}from"./index-Cjn3py5b.js";import{r as h}from"./vendor-BagLKi1z.js";import{d as x,D as z}from"./index-DiSWXAzL.js";import{F as a,e as j,I as l}from"./index-2ZNh93OQ.js";import{s as r}from"./index-lI4ucwGs.js";import{C as A}from"./index-7W5owr5O.js";import{F,C as S,P as B}from"./Table-DOoVuXeP.js";import{M as V,R as E}from"./DeleteOutlined-DhB81-EL.js";import{T as R}from"./index-Djy9bll3.js";import{T as y}from"./index-C8o8maEZ.js";import"./icons-X9-Iq-vF.js";import"./notifications-DStr16IZ.js";import"./ClockCircleOutlined-CWsPhV0W.js";import"./index-B-P4hzy5.js";const te=()=>{const[f,b]=h.useState([]),[w,g]=h.useState(!1),[T,n]=h.useState(!1),[d,o]=h.useState(null),[u]=a.useForm();h.useEffect(()=>{p()},[]);const p=async()=>{try{g(!0);const t=await P();b(t)}catch(t){console.error("Lỗi tải legal articles:",t),r.error("Không thể tải dữ liệu")}finally{g(!1)}},I=()=>{o(null),u.resetFields(),n(!0)},L=t=>{o(t),u.setFieldsValue({...t,datePublished:t.datePublished?x(t.datePublished):void 0,tags:t.tags?t.tags.join(", "):"",relatedLaws:t.relatedLaws?t.relatedLaws.join(", "):"",featured:!!t.featured,readTime:t.readTime??void 0}),n(!0)},k=async t=>{try{await M(t),r.success("Xóa thành công"),await p()}catch(i){console.error(i),r.error("Xóa thất bại")}},C=async t=>{try{const i={...t,datePublished:t.datePublished?t.datePublished.format("YYYY-MM-DD"):void 0,tags:t.tags?t.tags.split(",").map(s=>s.trim()).filter(s=>s):[],relatedLaws:t.relatedLaws?t.relatedLaws.split(",").map(s=>s.trim()).filter(s=>s):[]};d&&d.id?(await N(d.id,i),r.success("Cập nhật thành công")):(await Y(i),r.success("Thêm mới thành công")),n(!1),o(null),await p()}catch(i){console.error("Lỗi lưu article:",i),r.error("Lưu thất bại")}},D=[{title:"Tiêu đề",dataIndex:"title",key:"title",width:"25%"},{title:"Danh mục",dataIndex:"category",key:"category",width:"12%"},{title:"Tác giả",dataIndex:"author",key:"author",width:"12%"},{title:"Tags",dataIndex:"tags",key:"tags",width:"15%",render:(t=[])=>e.jsx(e.Fragment,{children:(t||[]).map((i,s)=>e.jsx(y,{color:"blue",style:{marginBottom:4},children:i},s))})},{title:"Nổi bật",dataIndex:"featured",key:"featured",width:"8%",align:"center",render:t=>t?e.jsx(y,{color:"gold",children:"Nổi bật"}):e.jsx("span",{style:{color:"#999"},children:"—"})},{title:"Ngày xuất bản",dataIndex:"datePublished",key:"datePublished",width:"12%",render:t=>t?x(t).format("DD/MM/YYYY"):e.jsx("span",{style:{color:"#999"},children:"—"})},{title:"Hành động",key:"actions",width:"10%",align:"center",render:(t,i)=>e.jsxs(m,{children:[e.jsx(c,{icon:e.jsx(v,{}),onClick:()=>L(i),size:"small"}),e.jsx(B,{title:"Xác nhận xóa",description:"Bạn có chắc muốn xóa bài viết này?",onConfirm:()=>k(i.id),okText:"Xóa",cancelText:"Hủy",okButtonProps:{danger:!0},children:e.jsx(c,{danger:!0,icon:e.jsx(E,{}),size:"small"})})]})}];return e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16},children:[e.jsx("h2",{children:"Quản lý Bài viết pháp luật"}),e.jsx(c,{type:"primary",icon:e.jsx(j,{}),onClick:I,children:"Thêm mới"})]}),e.jsx(A,{children:e.jsx(F,{dataSource:f,columns:D,rowKey:"id",loading:w,pagination:{pageSize:10,showTotal:t=>`Tổng ${t} bài viết`}})}),e.jsx(V,{title:e.jsx("div",{style:{fontSize:18,fontWeight:600},children:d?"✏️ Chỉnh sửa bài viết":"➕ Thêm bài viết mới"}),open:T,onCancel:()=>{n(!1),o(null)},footer:null,width:700,children:e.jsxs(a,{form:u,layout:"vertical",onFinish:C,initialValues:{},children:[e.jsx(a.Item,{name:"title",label:"Tiêu đề",rules:[{required:!0,message:"Vui lòng nhập tiêu đề"}],children:e.jsx(l,{placeholder:"Nhập tiêu đề bài viết",size:"large"})}),e.jsxs(m,{style:{width:"100%"},size:"large",children:[e.jsx(a.Item,{name:"category",label:"Danh mục",style:{width:200},children:e.jsx(l,{placeholder:"VD: Hôn nhân"})}),e.jsx(a.Item,{name:"author",label:"Tác giả",style:{width:200},children:e.jsx(l,{placeholder:"Tên tác giả"})})]}),e.jsxs(m,{style:{width:"100%"},size:"large",children:[e.jsx(a.Item,{name:"datePublished",label:"Ngày xuất bản",style:{width:200},children:e.jsx(z,{format:"DD/MM/YYYY",placeholder:"Chọn ngày",style:{width:"100%"}})}),e.jsx(a.Item,{name:"readTime",label:"Thời gian đọc (phút)",style:{width:200},children:e.jsx(R,{min:0,placeholder:"VD: 5",style:{width:"100%"}})})]}),e.jsx(a.Item,{name:"featured",valuePropName:"checked",children:e.jsx(S,{children:"⭐ Đánh dấu là bài viết nổi bật"})}),e.jsx(a.Item,{name:"tags",label:"Tags",extra:"Ngăn cách bởi dấu phẩy (,)",children:e.jsx(l,{placeholder:"hôn nhân, thừa phát lại, tư vấn pháp luật"})}),e.jsx(a.Item,{name:"relatedLaws",label:"Văn bản liên quan",extra:"Ngăn cách bởi dấu phẩy (,)",children:e.jsx(l,{placeholder:"Nghị định 123/2020, Luật dân sự 2015"})}),e.jsx(a.Item,{name:"content",label:"Nội dung",rules:[{required:!0,message:"Vui lòng nhập nội dung"}],children:e.jsx(l.TextArea,{rows:8,placeholder:"Nhập nội dung chi tiết của bài viết...",showCount:!0})}),e.jsx(a.Item,{style:{marginTop:24,marginBottom:0},children:e.jsxs(m,{children:[e.jsx(c,{htmlType:"submit",type:"primary",size:"large",icon:e.jsx(j,{}),children:d?"Cập nhật":"Thêm mới"}),e.jsx(c,{size:"large",onClick:()=>{n(!1),o(null)},children:"Hủy"})]})})]})})]})};export{te as default};
