import{cM as b,j as e,ao as l,aE as x,aG as w,cN as C,cO as S,cP as v}from"./index-Cjn3py5b.js";import{r as o}from"./vendor-BagLKi1z.js";import{F as r,e as F,I as d}from"./index-2ZNh93OQ.js";import{s as n}from"./index-lI4ucwGs.js";import{C as M}from"./index-7W5owr5O.js";import{F as E,P as L}from"./Table-DOoVuXeP.js";import{M as X,R as A}from"./DeleteOutlined-DhB81-EL.js";import{S as D}from"./index-DRT7L12W.js";import"./icons-X9-Iq-vF.js";import"./notifications-DStr16IZ.js";import"./index-B-P4hzy5.js";const G=()=>{const[f,p]=o.useState([]),[j,u]=o.useState(!1),[y,a]=o.useState(!1),[c,i]=o.useState(null),[m]=r.useForm();o.useEffect(()=>{h()},[]);const h=async()=>{try{u(!0);const t=await b();p(t)}catch(t){console.error(t),n.error("Không thể tải dữ liệu")}finally{u(!1)}},g=()=>{i(null),m.resetFields(),a(!0)},I=t=>{i(t),m.setFieldsValue(t),a(!0)},k=async t=>{try{await v(t),n.success("Xóa thành công"),await h()}catch(s){console.error(s),n.error("Xóa thất bại")}},R=async t=>{try{c&&c.id?(await C(c.id,t),n.success("Cập nhật thành công")):(await S(t),n.success("Thêm mới thành công")),a(!1),i(null),await h()}catch(s){console.error(s),n.error("Lưu thất bại")}},T=[{title:"Tiêu đề",dataIndex:"title",key:"title"},{title:"Danh mục",dataIndex:"category",key:"category"},{title:"URL",dataIndex:"url",key:"url",render:t=>t?e.jsx("a",{href:t,target:"_blank",rel:"noreferrer",children:t}):""},{title:"Xác minh",dataIndex:"verified",key:"verified",render:t=>t?"Có":"Không"},{title:"Hành động",key:"actions",render:(t,s)=>e.jsxs(x,{children:[e.jsx(l,{icon:e.jsx(w,{}),onClick:()=>I(s)}),e.jsx(L,{title:"Bạn có chắc muốn xóa?",onConfirm:()=>k(s.id),okText:"Xóa",cancelText:"Hủy",children:e.jsx(l,{danger:!0,icon:e.jsx(A,{})})})]})}];return e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16},children:[e.jsx("h2",{children:"Quản lý Tài liệu tham khảo"}),e.jsx(l,{type:"primary",icon:e.jsx(F,{}),onClick:g,children:"Thêm mới"})]}),e.jsx(M,{children:e.jsx(E,{dataSource:f,columns:T,rowKey:"id",loading:j})}),e.jsx(X,{title:c?"Sửa":"Thêm mới",open:y,onCancel:()=>{a(!1),i(null)},footer:null,children:e.jsxs(r,{form:m,layout:"vertical",onFinish:R,initialValues:{verified:!1},children:[e.jsx(r.Item,{name:"title",label:"Tiêu đề",rules:[{required:!0}],children:e.jsx(d,{})}),e.jsx(r.Item,{name:"category",label:"Danh mục",children:e.jsx(d,{})}),e.jsx(r.Item,{name:"url",label:"URL",children:e.jsx(d,{})}),e.jsx(r.Item,{name:"description",label:"Mô tả",children:e.jsx(d.TextArea,{rows:3})}),e.jsx(r.Item,{name:"verified",label:"Xác minh",valuePropName:"checked",children:e.jsx(D,{})}),e.jsx(r.Item,{style:{marginTop:16},children:e.jsxs(x,{children:[e.jsx(l,{htmlType:"submit",type:"primary",children:"Lưu"}),e.jsx(l,{onClick:()=>{a(!1),i(null)},children:"Hủy"})]})})]})})]})};export{G as default};
