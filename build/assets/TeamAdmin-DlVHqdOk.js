import{n as k,j as t,aE as p,ao as d,aG as M,bu as S,bv as L,bw as E}from"./index-Cjn3py5b.js";import{r as a}from"./vendor-BagLKi1z.js";import{F as n,I as i,e as F}from"./index-2ZNh93OQ.js";import{s}from"./index-lI4ucwGs.js";import{C as R}from"./index-7W5owr5O.js";import{F as V,P as A}from"./Table-DOoVuXeP.js";import{M as N,R as B}from"./DeleteOutlined-DhB81-EL.js";import"./icons-X9-Iq-vF.js";import"./notifications-DStr16IZ.js";import"./index-B-P4hzy5.js";const{Search:O}=i,J=()=>{const[j,f]=a.useState([]),[g,r]=a.useState(!1),[c,m]=a.useState(null),[T,u]=a.useState(""),[o]=n.useForm(),[P,x]=a.useState(!1);a.useEffect(()=>{h()},[]);const h=async()=>{try{x(!0);const e=await k();f(e)}catch(e){console.error("Lỗi tải thành viên đội ngũ:",e),s.error("Không thể tải dữ liệu thành viên đội ngũ")}finally{x(!1)}},y=()=>{m(null),o.resetFields(),r(!0)},I=e=>{m(e.id),o.setFieldsValue({name:e.name,position:e.position,email:e.email,phone:e.phone,bio:e.bio}),r(!0)},b=async()=>{try{const e=await o.validateFields();c?(await S(c,e),s.success("Cập nhật thành công")):(await L(e),s.success("Thêm mới thành công")),r(!1),h()}catch(e){console.error("Lỗi lưu thành viên đội ngũ:",e),s.error(`Lỗi lưu dữ liệu: ${e instanceof Error?e.message:"Lỗi không xác định"}`)}},v=async e=>{try{await E(e),s.success("Xóa thành công"),h()}catch(l){console.error("Lỗi xóa thành viên:",l),s.error("Xóa thất bại")}},w=j.filter(e=>e.name.toLowerCase().includes(T.toLowerCase())),C=[{title:"Tên",dataIndex:"name",key:"name"},{title:"Chức vụ",dataIndex:"position",key:"position"},{title:"Email",dataIndex:"email",key:"email",render:e=>e||"-"},{title:"Phone",dataIndex:"phone",key:"phone",render:e=>e||"-"},{title:"Thao tác",key:"actions",render:(e,l)=>t.jsxs(p,{children:[t.jsx(d,{icon:t.jsx(M,{}),onClick:()=>I(l)}),t.jsx(A,{title:"Bạn chắc chắn muốn xóa?",onConfirm:()=>v(l.id),okText:"Xóa",cancelText:"Hủy",children:t.jsx(d,{danger:!0,icon:t.jsx(B,{})})})]})}];return t.jsxs("div",{children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16},children:[t.jsx("h2",{children:"Quản Lý Đội Ngũ"}),t.jsxs(p,{children:[t.jsx(O,{placeholder:"Tìm kiếm...",onSearch:e=>u(e),onChange:e=>u(e.target.value),style:{width:240},allowClear:!0}),t.jsx(d,{type:"primary",icon:t.jsx(F,{}),onClick:y,children:"Thêm mới"})]})]}),t.jsx(R,{children:t.jsx(V,{dataSource:w,columns:C,rowKey:"id"})}),t.jsx(N,{title:c?"Sửa Thành Viên Đội Ngũ":"Thêm Thành Viên Đội Ngũ",open:g,onCancel:()=>r(!1),onOk:b,okText:"Lưu",children:t.jsxs(n,{form:o,layout:"vertical",children:[t.jsx(n.Item,{name:"name",label:"Tên",rules:[{required:!0,message:"Vui lòng nhập tên"}],children:t.jsx(i,{})}),t.jsx(n.Item,{name:"position",label:"Chức vụ",rules:[{required:!0,message:"Vui lòng nhập chức vụ"}],children:t.jsx(i,{})}),t.jsx(n.Item,{name:"email",label:"Email",children:t.jsx(i,{})}),t.jsx(n.Item,{name:"phone",label:"Điện thoại",children:t.jsx(i,{})}),t.jsx(n.Item,{name:"bio",label:"Tiểu sử",children:t.jsx(i.TextArea,{rows:3})})]})})]})};export{J as default};
