import{bx as k,j as e,ao as l,aE as x,aG as w,by as F,bz as S,bA as L}from"./index-Cjn3py5b.js";import{r as o}from"./vendor-BagLKi1z.js";import{F as v}from"./FileUploadCloudinary-BXH5zxUQ.js";import{F as n,e as E,I as m}from"./index-2ZNh93OQ.js";import{s as a}from"./index-lI4ucwGs.js";import{C as N}from"./index-7W5owr5O.js";import{F as R,P as A}from"./Table-DOoVuXeP.js";import{M,R as q}from"./DeleteOutlined-DhB81-EL.js";import{T as B}from"./index-Djy9bll3.js";import{S as H}from"./index-DRT7L12W.js";import"./icons-X9-Iq-vF.js";import"./notifications-DStr16IZ.js";import"./index-CRVR9_FD.js";import"./index-B-P4hzy5.js";const Y=()=>{const[p,f]=o.useState([]),[j,u]=o.useState(!1),[y,i]=o.useState(!1),[c,r]=o.useState(null),[d]=n.useForm();o.useEffect(()=>{h()},[]);const h=async()=>{try{u(!0);const t=await k();f(t)}catch(t){console.error("Lỗi tải testimonials:",t),a.error("Không thể tải testimonials")}finally{u(!1)}},g=()=>{r(null),d.resetFields(),i(!0)},I=t=>{r(t),d.setFieldsValue(t),i(!0)},b=async t=>{try{await L(t),a.success("Xóa thành công"),await h()}catch(s){console.error("Lỗi xóa testimonial:",s),a.error("Xóa thất bại")}},T=async t=>{try{c&&c.id?(await F(c.id,t),a.success("Cập nhật thành công")):(await S(t),a.success("Thêm mới thành công")),i(!1),r(null),await h()}catch(s){console.error("Lỗi lưu testimonial:",s),a.error("Lưu thất bại")}},C=[{title:"Tên",dataIndex:"name",key:"name"},{title:"Chức vụ",dataIndex:"position",key:"position"},{title:"Công ty",dataIndex:"company",key:"company"},{title:"Nội dung",dataIndex:"content",key:"content",render:t=>t?t.slice(0,80)+(t.length>80?"...":""):""},{title:"Rating",dataIndex:"rating",key:"rating"},{title:"Nổi bật",dataIndex:"featured",key:"featured",render:t=>t?"Có":"Không"},{title:"Hành động",key:"actions",render:(t,s)=>e.jsxs(x,{children:[e.jsx(l,{icon:e.jsx(w,{}),onClick:()=>I(s)}),e.jsx(A,{title:"Bạn có chắc muốn xóa?",onConfirm:()=>b(s.id),okText:"Xóa",cancelText:"Hủy",children:e.jsx(l,{danger:!0,icon:e.jsx(q,{})})})]})}];return e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16},children:[e.jsx("h2",{children:"Quản lý Lời chứng thực"}),e.jsx(l,{type:"primary",icon:e.jsx(E,{}),onClick:g,children:"Thêm mới"})]}),e.jsx(N,{children:e.jsx(R,{dataSource:p,columns:C,rowKey:"id",loading:j})}),e.jsx(M,{title:c?"Sửa lời chứng thực":"Thêm lời chứng thực",open:y,onCancel:()=>{i(!1),r(null)},footer:null,children:e.jsxs(n,{form:d,layout:"vertical",onFinish:T,initialValues:{rating:5,featured:!1},children:[e.jsxs(n.Item,{name:"name",label:"Tên",rules:[{required:!0}],children:[" ",e.jsx(m,{})," "]}),e.jsxs(n.Item,{name:"position",label:"Chức vụ",children:[" ",e.jsx(m,{})," "]}),e.jsxs(n.Item,{name:"company",label:"Công ty",children:[" ",e.jsx(m,{})," "]}),e.jsxs(n.Item,{name:"content",label:"Nội dung",rules:[{required:!0}],children:[" ",e.jsx(m.TextArea,{rows:4})," "]}),e.jsx(n.Item,{name:"rating",label:"Đánh giá",rules:[{required:!0}],children:e.jsx(B,{min:1,max:5})}),e.jsxs(n.Item,{name:"featured",label:"Nổi bật",valuePropName:"checked",children:[" ",e.jsx(H,{})," "]}),e.jsxs(n.Item,{name:"image",label:"Ảnh",children:[" ",e.jsx(v,{folder:"testimonials"})," "]}),e.jsx(n.Item,{style:{marginTop:16},children:e.jsxs(x,{children:[e.jsx(l,{htmlType:"submit",type:"primary",children:"Lưu"}),e.jsx(l,{onClick:()=>{i(!1),r(null)},children:"Hủy"})]})})]})})]})};export{Y as default};
